(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[746],{1572:(e,a,l)=>{Promise.resolve().then(l.bind(l,79065))},3163:(e,a,l)=>{"use strict";l.d(a,{Id:()=>s,YV:()=>c,bf:()=>n,dY:()=>r,h6:()=>d,or:()=>t,qW:()=>o,x3:()=>i});let t=[{label:"真人轮抽",value:"PremierDraft"},{label:"选两张轮抽",value:"PickTwoDraft"},{label:"快速轮抽",value:"QuickDraft"},{label:"现开赛",value:"Sealed"},{label:"真人轮抽BO3",value:"TradDraft"},{label:"选两张轮抽BO3",value:"PickTwoTradDraft"},{label:"现开赛BO3",value:"TradSealed"},{label:"神器混合真人轮抽",value:"PremierDraftRemixArtifacts"},{label:"竞技场直邮赛轮抽",value:"ArenaDirect_Draft"},{label:"竞技场直邮赛现开",value:"ArenaDirect_Sealed"},{label:"机器轮抽",value:"BotDraft"},{label:"竞技轮抽",value:"CompDraft"},{label:"方盒现开",value:"CubeSealed"},{label:"十项全能决赛2022",value:"DecathlonFinals2022"},{label:"十项全能决赛2023",value:"DecathlonFinals2023"},{label:"十项全能快速轮抽",value:"DecathlonQuickDraft"},{label:"十项全能真人轮抽",value:"DecathlonTradDraft"},{label:"轮抽挑战赛",value:"DraftChallenge"},{label:"徽记快速轮抽",value:"Emblem_QuickDraft"},{label:"电竞资格赛轮抽D1",value:"EsportsQualifierDraft_D1"},{label:"电竞资格赛轮抽D2",value:"EsportsQualifierDraft_D2"},{label:"电竞轮抽",value:"Esports_Draft"},{label:"FIAB现开",value:"FIAB_Sealed"},{label:"周中快速轮抽",value:"MidWeekQuickDraft"},{label:"周中现开",value:"MidWeekSealed"},{label:"全知全能轮抽",value:"Omniscience_Draft"},{label:"公开赛第一日轮抽BO1",value:"OpenDraft_D1_Bo1"},{label:"公开赛第一日轮抽BO3",value:"OpenDraft_D1_Bo3"},{label:"公开赛第二日轮抽BO3",value:"OpenDraft_D2_Bo3"},{label:"公开赛第二日轮抽1 BO3",value:"OpenDraft_D2_Draft1_Bo3"},{label:"公开赛第二日轮抽2B BO3",value:"OpenDraft_D2_Draft2B_Bo3"},{label:"公开赛第二日轮抽2 BO3",value:"OpenDraft_D2_Draft2_Bo3"},{label:"公开赛第一日现开BO1",value:"OpenSealed_D1_Bo1"},{label:"公开赛第一日现开BO3",value:"OpenSealed_D1_Bo3"},{label:"公开赛第二日现开BO3",value:"OpenSealed_D2_Bo3"},{label:"公开赛第二日现开1 BO3",value:"OpenSealed_D2_Sealed1_Bo3"},{label:"公开赛第二日现开2 BO3",value:"OpenSealed_D2_Sealed2_Bo3"},{label:"资格赛预选现开",value:"QualifierPlayInSealed"},{label:"资格赛预选现开BO3",value:"QualifierPlayInTradSealed"},{label:"资格赛第一日现开",value:"Qualifier_D1_Sealed"},{label:"资格赛第二日轮抽",value:"Qualifier_D2_Draft"},{label:"资格赛第二日现开",value:"Qualifier_D2_Sealed"}],r=[{label:"真人轮抽",value:"PremierDraft"},{label:"选两张轮抽",value:"PickTwoDraft"},{label:"快速轮抽",value:"QuickDraft"},{label:"现开赛",value:"Sealed"},{label:"真人轮抽BO3",value:"TradDraft"},{label:"现开赛BO3",value:"TradSealed"},{label:"神器混合真人轮抽",value:"PremierDraftRemixArtifacts"},{label:"公开赛第二日现开BO3",value:"OpenSealed_D2_Bo3"},{label:"公开赛第二日轮抽BO3",value:"OpenDraft_D2_Bo3"},{label:"公开赛第一日轮抽BO1",value:"OpenDraft_D1_Bo1"},{label:"公开赛第二日轮抽BO3",value:"OpenDraft_D2_Draft1_Bo3"},{label:"全知轮抽",value:"Omniscience_Draft"},{label:"中周现开",value:"MidWeekSealed"},{label:"中周轮抽",value:"MidWeekQuickDraft"},{label:"轮抽挑战赛",value:"DraftChallenge"},{label:"十项全能真人轮抽",value:"DecathlonTradDraft"},{label:"十项全能快速轮抽",value:"DecathlonQuickDraft"},{label:"十项全能决赛2022",value:"DecathlonFinals2022"},{label:"混沌轮抽",value:"CubeDraft"},{label:"资格赛预选现开",value:"QualifierPlayInSealed"},{label:"资格赛预选现开BO3",value:"QualifierPlayInTradSealed"},{label:"资格赛第一日现开",value:"Qualifier_D1_Sealed"},{label:"公开赛第一日现开BO3",value:"OpenSealed_D1_Bo3"},{label:"公开赛第一日现开BO1",value:"OpenSealed_D1_Bo1"},{label:"竞技场直邮赛现开",value:"ArenaDirect_Sealed"}],s=[{label:"OM1",value:"OM1"},{label:"EOE",value:"EOE"},{label:"Y25EOE",value:"Y25EOE"},{label:"FIN",value:"FIN"},{label:"TDM",value:"TDM"},{label:"Y25TDM",value:"Y25TDM"},{label:"DFT",value:"DFT"},{label:"Y25DFT",value:"Y25DFT"},{label:"PIO",value:"PIO"},{label:"FDN",value:"FDN"},{label:"DSK",value:"DSK"},{label:"Y25DSK",value:"Y25DSK"},{label:"BLB",value:"BLB"},{label:"Y25BLB",value:"Y25BLB"},{label:"MH3",value:"MH3"},{label:"OTJ",value:"OTJ"},{label:"Y24OTJ",value:"Y24OTJ"},{label:"MKM",value:"MKM"},{label:"Y24MKM",value:"Y24MKM"},{label:"LCI",value:"LCI"},{label:"Y24LCI",value:"Y24LCI"},{label:"WOE",value:"WOE"},{label:"Y24WOE",value:"Y24WOE"},{label:"LTR",value:"LTR"},{label:"MOM",value:"MOM"},{label:"MAT",value:"MAT"},{label:"SIR",value:"SIR"},{label:"ONE",value:"ONE"},{label:"Y23ONE",value:"Y23ONE"},{label:"BRO",value:"BRO"},{label:"Y23BRO",value:"Y23BRO"},{label:"DMU",value:"DMU"},{label:"Y23DMU",value:"Y23DMU"},{label:"HBG",value:"HBG"},{label:"SNC",value:"SNC"},{label:"Y22SNC",value:"Y22SNC"},{label:"NEO",value:"NEO"},{label:"DBL",value:"DBL"},{label:"VOW",value:"VOW"},{label:"RAVM",value:"RAVM"},{label:"MID",value:"MID"},{label:"AFR",value:"AFR"},{label:"STX",value:"STX"},{label:"CORE",value:"CORE"},{label:"KHM",value:"KHM"},{label:"KLR",value:"KLR"},{label:"ZNR",value:"ZNR"},{label:"AKR",value:"AKR"},{label:"M21",value:"M21"},{label:"IKO",value:"IKO"},{label:"THB",value:"THB"},{label:"ELD",value:"ELD"},{label:"Ravnica",value:"Ravnica"},{label:"M20",value:"M20"},{label:"WAR",value:"WAR"},{label:"M19",value:"M19"},{label:"DOM",value:"DOM"},{label:"RIX",value:"RIX"},{label:"GRN",value:"GRN"},{label:"RNA",value:"RNA"},{label:"KTK",value:"KTK"},{label:"XLN",value:"XLN"},{label:"Cube - Powered",value:"Cube - Powered"},{label:"Cube",value:"Cube"},{label:"Chaos",value:"Chaos"}],n=[{label:"所有用户",value:""},{label:"低级",value:"bottom"},{label:"中级",value:"middle"},{label:"顶级",value:"top"}],i=[{label:"全部套牌",value:""},{label:"W",value:"W"},{label:"U",value:"U"},{label:"B",value:"B"},{label:"R",value:"R"},{label:"G",value:"G"},{label:"WU",value:"WU"},{label:"WB",value:"WB"},{label:"WR",value:"WR"},{label:"WG",value:"WG"},{label:"UB",value:"UB"},{label:"UR",value:"UR"},{label:"UG",value:"UG"},{label:"BR",value:"BR"},{label:"BG",value:"BG"},{label:"RG",value:"RG"},{label:"WUB",value:"WUB"},{label:"WUR",value:"WUR"},{label:"WUG",value:"WUG"},{label:"WBR",value:"WBR"},{label:"WBG",value:"WBG"},{label:"WRG",value:"WRG"},{label:"UBR",value:"UBR"},{label:"UBG",value:"UBG"},{label:"URG",value:"URG"},{label:"BRG",value:"BRG"},{label:"WUBR",value:"WUBR"},{label:"WUBG",value:"WUBG"},{label:"WURG",value:"WURG"},{label:"WBRG",value:"WBRG"},{label:"UBRG",value:"UBRG"},{label:"WUBRG",value:"WUBRG"}],o=[{label:"W",value:"W"},{label:"U",value:"U"},{label:"B",value:"B"},{label:"R",value:"R"},{label:"G",value:"G"},{label:"M",value:"M"},{label:"C",value:"C"}],c=[{label:"普通",value:"common"},{label:"非普通",value:"uncommon"},{label:"稀有",value:"rare"},{label:"秘稀",value:"mythic"}],d=Object.fromEntries(t.map(e=>[e.value,e.label]))},15659:(e,a,l)=>{"use strict";l.d(a,{$:()=>r});var t=l(82995);function r(e){let{variant:a="primary",size:l="md",className:r,...s}=e;return(0,t.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[--primary]"," ").concat({primary:"bg-[--primary] text-[--primary-foreground] hover:brightness-110 active:scale-[0.98]",secondary:"bg-[--background-subtle] text-[--foreground] hover:brightness-95 active:scale-[0.98]",ghost:"bg-transparent text-[--foreground-muted] hover:bg-[--background-subtle] hover:text-[--foreground] active:scale-[0.98]"}[a]," ").concat({sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",icon:"h-9 w-9 p-0"}[l]," ").concat(r),...s})}},58069:(e,a,l)=>{"use strict";l.d(a,{U:()=>r});var t=l(79283);function r(e){let[a,l]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let a=window.matchMedia(e);l(a.matches);let t=e=>{l(e.matches)};return a.addEventListener("change",t),()=>{a.removeEventListener("change",t)}},[e]),a}},67283:(e,a,l)=>{"use strict";l.d(a,{l:()=>r});var t=l(82995);function r(e){let{label:a,error:l,options:r,className:s,...n}=e;return(0,t.jsxs)("div",{className:"space-y-2",children:[a&&(0,t.jsx)("label",{className:"text-sm font-medium text-[--component-foreground]",children:a}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("select",{className:"\n            w-full rounded-md border border-[--border] bg-[--component-background] px-3 pr-10 py-2 text-sm text-[--component-foreground]\n            appearance-none\n            focus:border-[--primary] focus:outline-none focus:ring-1 focus:ring-[--primary]\n            disabled:cursor-not-allowed disabled:opacity-50\n            ".concat(s,"\n          "),...n,children:r.map(e=>(0,t.jsx)("option",{value:e.value,className:"bg-[--component-background]",children:e.label},e.value))}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2",children:(0,t.jsx)("svg",{className:"h-4 w-4 fill-current text-[--component-foreground-muted]",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),l&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:l})]})}},70557:(e,a,l)=>{"use strict";l.d(a,{p:()=>r});var t=l(82995);function r(e){let{label:a,error:l,className:r,readOnly:s,...n}=e;return(0,t.jsxs)("div",{className:"space-y-2",children:[a&&(0,t.jsx)("label",{className:"text-sm font-medium text-[--component-foreground]",children:a}),(0,t.jsx)("input",{className:"\n          w-full rounded-md border border-[--border] bg-[--component-background] px-3 py-2 text-sm text-[--component-foreground]\n          placeholder:text-[--component-foreground-muted]\n          focus:border-[--primary] focus:outline-none focus:ring-1 focus:ring-[--primary]\n          disabled:cursor-not-allowed disabled:opacity-50\n          ".concat(s?"focus:ring-0 focus:border-[--border] cursor-default":"","\n          ").concat(r,"\n        "),readOnly:s,...n}),l&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:l})]})}},79065:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>ei});var t=l(82995),r=l(79283);function s(e){let{data:a,columns:l,isLoading:s,emptyText:n="暂无数据",sortColumn:i,sortDirection:o,onSort:c,expansion:d=""}=e,u=(0,r.useRef)(null),m=(0,r.useRef)(null),[h,x]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),p=(0,r.useCallback)(e=>{u.current=e,x(e)},[]),g=(0,r.useCallback)(e=>{m.current=e,b(e)},[]),f=(0,r.useCallback)(()=>{var e;if(!m.current)return;let a=m.current.querySelectorAll("td");if(!a.length)return;let t=Array.from(a).slice(0,l.length).map(e=>e.getBoundingClientRect().width);if(!t.some((e,a)=>{var l,t;return Math.abs(((null==(t=u.current)||null==(l=t.querySelectorAll("th")[a])?void 0:l.getBoundingClientRect().width)||0)-e)>.1}))return;let r=null==(e=u.current)?void 0:e.querySelectorAll("th");r&&r.forEach((e,a)=>{e.style.width="".concat(t[a],"px"),e.style.maxWidth="".concat(t[a],"px"),e.style.minWidth="".concat(t[a],"px")})},[l.length]),j=(0,r.useCallback)((e,a)=>l=>{let t=l.target;t===e?requestAnimationFrame(()=>{a.scrollLeft=t.scrollLeft}):requestAnimationFrame(()=>{e.scrollLeft=t.scrollLeft})},[]),w=(0,r.useMemo)(()=>(0,t.jsx)("tr",{children:l.map(e=>(0,t.jsx)("th",{className:"\n            px-4 py-3 text-left text-sm font-medium text-[--table-header-foreground] whitespace-nowrap\n            ".concat(e.sortable?"cursor-pointer hover:text-[--primary]":"","\n          "),title:e.title,onClick:()=>e.sortable&&(null==c?void 0:c(e.accessorKey)),children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[e.header,e.sortable&&i===e.accessorKey&&(0,t.jsx)("span",{className:"text-[--primary]",children:"asc"===o?"↑":"↓"})]})},String(e.accessorKey)))}),[l,i,o,c]);return((0,r.useEffect)(()=>{if(!h||!v)return;let e=j(h,v);return h.addEventListener("scroll",e),v.addEventListener("scroll",e),()=>{h.removeEventListener("scroll",e),v.removeEventListener("scroll",e)}},[j,h,v]),(0,r.useEffect)(()=>{var e;f(),window.addEventListener("resize",f);let a=new ResizeObserver(f),t=null==(e=m.current)?void 0:e.querySelectorAll("td");return t&&Array.from(t).slice(0,l.length).forEach(e=>{a.observe(e)}),()=>{window.removeEventListener("resize",f),a.disconnect()}},[a,f,l.length]),s)?(0,t.jsx)("div",{className:"w-full h-96 flex items-center justify-center text-[--muted-foreground]",children:"加载中..."}):a.length?(0,t.jsxs)("div",{className:"w-full relative",children:[(0,t.jsx)("div",{ref:p,className:"w-full overflow-x-auto border-b border-[--table-border] bg-[--background]",style:{position:"sticky",top:"64px",zIndex:1},children:(0,t.jsx)("table",{className:"min-w-full w-max border-collapse",children:(0,t.jsx)("thead",{children:w})})}),(0,t.jsx)("div",{ref:g,className:"w-full overflow-x-auto [scrollbar-width:none] [-ms-overflow-style:none] [&::-webkit-scrollbar]:hidden",children:(0,t.jsx)("table",{className:"min-w-full w-max border-collapse",children:(0,t.jsx)("tbody",{children:a.map((e,r)=>(0,t.jsx)("tr",{className:"border-b border-[--table-border] hover:bg-[--table-row-hover]",children:l.map(l=>(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-[--foreground] whitespace-nowrap",children:l.cell?l.cell(e[l.accessorKey],e,a,d):String(e[l.accessorKey])},String(l.accessorKey)))},r))})})})]}):(0,t.jsx)("div",{className:"w-full h-96 flex items-center justify-center text-[--muted-foreground]",children:n})}var n=l(15659),i=l(43711),o=l(9187);let c=[{header:"# Seen",title:"轮抽中见过的次数",description:'这张卡在轮抽包中被看到的次数。如果一张卡传回来又被看到（"轮回"），只计算一次。注意：由于Arena限制，P1P1有时只记录选择的牌，该牌也会被计入"见过"的统计。'},{header:"ALSA",title:"平均最后见到的抓位",description:"Average Last Seen At - 这张卡在轮抽包中最后一次被看到时的平均顺位。如果卡片轮回，只有第二次看到时的顺位才会计入平均值。数值越小说明这张卡越受欢迎，因为它更早被选走而不会轮回。"},{header:"# Picked",title:"被选择的次数",description:"17Lands用户在轮抽中选择这张卡的总次数。"},{header:"ATA",title:"平均选择抓位",description:"Average Taken At - 17Lands用户选择这张卡时的平均顺位。数值越小说明这张卡的优先级越高，通常意味着更强力。"},{header:"# GP",title:"使用过的对局数量",description:"Games Played - 这张卡在主牌中被使用的对局数量，按副数加权。例如：主牌带3张该卡打8局，权重为24（3\xd78）。"},{header:"% GP",title:"主牌使用率",description:"Play Rate - 当卡池中有这张卡时，将其放入主牌的比率，按对局数和副数加权。高使用率说明这张卡更可能进入主牌而不是备牌。注意：Bo3赛制中，备牌局数也会影响此数据。"},{header:"GP WR",title:"主牌使用时的胜率",description:"Games Played Win Rate - 主牌中至少有一张该卡的套牌胜率，按副数加权。主牌带10张该卡的权重是带1张的10倍。"},{header:"# OH",title:"在起手的对局数量",description:'Opening Hand - 这张卡在起手手牌中出现的次数，每张单独计数。"起手"是指调度后决定保留的全部手牌（包括调度时置底的牌，以及如Leyline类在游戏开始时就进战场的牌）。'},{header:"OH WR",title:"在起手时的胜率",description:"Opening Hand Win Rate - 起手有这张卡时的胜率，按副数加权。注意：昂贵或难施放的牌可能因更容易导致调度而有偏差。"},{header:"# GD",title:"抽到的对局数量",description:'Game Drawn - 从牌库抽到这张卡的次数（不包括起手）。包括回合抽牌和抽牌效应，但不包括从战场/坟场返回手牌、检索、或从放逐区使用的牌。"检索"指任何从牌库中选择牌的效应（包括进化荒野等）。'},{header:"GD WR",title:"抽到时的胜率",description:"Game Drawn Win Rate - 从牌库抽到这张卡时的胜率（不包括起手），按副数加权。"},{header:"# GIH",title:"在手上的对局数量",description:"Game In Hand - 这张卡进入手牌的总次数（起手+抽到），每张单独计数。极少数情况下，同一张牌可能被多次抽到（如被洗回牌库）。"},{header:"GIH WR",title:"在手上时的胜率",description:"Game In Hand Win Rate - 这张卡进入手牌时的胜率（起手+抽到），按副数加权。这是评估卡牌强度最重要的指标之一，因为它反映了实际拿到牌时对胜率的影响。"},{header:"# GNS",title:"未见到的数量",description:'Game Not Seen - 主牌中的副数减去被抽到或检索到（"见到"）的副数。如果见到的副数超过主牌副数，此值为0。按未见到的副数加权。'},{header:"GNS WR",title:"未见到时的胜率",description:"Game Not Seen Win Rate - 主牌中有这张卡但整局都未见到时的胜率，按未见到的副数加权。"},{header:"IIH",title:"在手时的胜率提升",description:"Improvement In Hand - GIH WR与GNS WR的差值，表示拿到这张卡相比未拿到时的胜率提升。正值越大说明这张卡对胜利的贡献越大。注意：此指标是简单差值，未按对局数加权，可能高估强力后期牌的价值。"}];function d(){let[e,a]=(0,r.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>a(!0),title:"查看指标说明",className:"h-8 w-8 text-[--foreground-muted] hover:text-[--foreground]",children:(0,t.jsx)(i.A,{className:"h-4 w-4"})}),e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>a(!1)}),(0,t.jsxs)("div",{className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[calc(100%-2rem)] sm:w-full max-w-2xl max-h-[85vh] sm:max-h-[80vh] bg-[--component-background] rounded-lg shadow-xl z-50 overflow-hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-[--border]",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-[--foreground]",children:"指标说明"}),(0,t.jsx)("button",{onClick:()=>a(!1),className:"text-[--foreground-muted] hover:text-[--foreground] transition-colors",children:(0,t.jsx)(o.A,{className:"h-5 w-5"})})]}),(0,t.jsx)("div",{className:"overflow-y-auto p-4 sm:p-6 flex-1",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-bold text-[--foreground] mb-3 pb-2 border-b border-[--border]",children:"轮抽数据 (In-Draft Statistics)"}),(0,t.jsx)("div",{className:"space-y-3",children:c.slice(0,4).map((e,a)=>(0,t.jsxs)("div",{className:"p-3 rounded-md bg-[--background-subtle] hover:bg-[--background-hover] transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-baseline gap-2 mb-1.5",children:[(0,t.jsx)("span",{className:"font-semibold text-[--foreground] text-sm whitespace-nowrap",children:e.header}),(0,t.jsx)("span",{className:"text-xs text-[--foreground-muted]",children:e.title})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-[--foreground-muted] leading-relaxed",children:e.description})]},a))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-bold text-[--foreground] mb-3 pb-2 border-b border-[--border]",children:"对局数据 (In-Game Statistics)"}),(0,t.jsx)("div",{className:"space-y-3",children:c.slice(4).map((e,a)=>(0,t.jsxs)("div",{className:"p-3 rounded-md bg-[--background-subtle] hover:bg-[--background-hover] transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-baseline gap-2 mb-1.5",children:[(0,t.jsx)("span",{className:"font-semibold text-[--foreground] text-sm whitespace-nowrap",children:e.header}),(0,t.jsx)("span",{className:"text-xs text-[--foreground-muted]",children:e.title})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-[--foreground-muted] leading-relaxed",children:e.description})]},a))})]})]})}),(0,t.jsx)("div",{className:"px-4 py-3 border-t border-[--border] flex justify-end",children:(0,t.jsx)(n.$,{variant:"secondary",size:"sm",onClick:()=>a(!1),children:"我知道了"})})]})]})]})}function u(e){let{columns:a,visibleColumns:l,onColumnToggle:s}=e,[i,o]=(0,r.useState)(!1),c=(0,r.useMemo)(()=>{let e=["name","color","rarity"];return a.filter(a=>!e.includes(a.accessorKey))},[a]),u=(0,r.useMemo)(()=>c.filter(e=>l.has(String(e.accessorKey))).length,[c,l]);return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"sm:hidden mb-2 flex items-center gap-2",children:[(0,t.jsxs)(n.$,{variant:"secondary",size:"sm",onClick:()=>o(!i),className:"flex-1 flex items-center justify-between bg-[--component-background]",children:[(0,t.jsx)("span",{children:"显示/隐藏列"}),(0,t.jsxs)("span",{className:"text-xs text-[--foreground-muted]",children:[u,"/",c.length]})]}),(0,t.jsx)(d,{})]}),(0,t.jsxs)("div",{className:"hidden sm:flex sm:items-center sm:gap-3",children:[(0,t.jsxs)("span",{className:"text-sm text-[--component-foreground-muted] flex items-center gap-1",children:["显示/隐藏列：",(0,t.jsx)(d,{})]}),(0,t.jsx)("div",{className:"flex-1 min-w-[240px] overflow-x-auto",children:(0,t.jsx)("div",{className:"flex items-center gap-2 whitespace-nowrap pb-1",children:c.map(e=>{let a=String(e.accessorKey),r=l.has(a);return(0,t.jsx)(n.$,{variant:r?"secondary":"ghost",size:"sm",onClick:()=>s(a),title:e.title,className:"inline-flex justify-center text-sm rounded-full px-4 border transition-all ".concat(r?"bg-gradient-to-r from-[--accent]/20 to-[--accent]/10 text-[--foreground] border-[--accent]/60 font-medium shadow-sm hover:border-[--accent]":"bg-[--component-background] text-[--foreground-muted] border-[--border] hover:text-[--foreground] hover:border-[--accent]/50"),children:e.header},a)})})})]}),(0,t.jsx)("div",{className:"sm:hidden ".concat(i?"":"hidden"),children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:c.map(e=>{let a=String(e.accessorKey),r=l.has(a);return(0,t.jsx)(n.$,{variant:r?"secondary":"ghost",size:"sm",onClick:()=>s(a),title:e.title,className:"w-full justify-start text-sm rounded-full border transition-all ".concat(r?"bg-gradient-to-r from-[--accent]/20 to-[--accent]/10 text-[--foreground] border-[--accent]/60 font-medium shadow-sm hover:border-[--accent]":"bg-[--component-background] text-[--foreground-muted] border-[--border] hover:text-[--foreground] hover:border-[--accent]/50"),children:e.header},a)})})})]})}var m=l(91848);function h(e){let{color:a}=e,l=""===a?["C"]:a.split("").sort(),r=5===l.length?"-space-x-2":l.length>=3?"-space-x-1":"gap-0.5";return(0,t.jsx)("div",{className:"flex ".concat(r),children:l.map((e,a)=>(0,t.jsx)("div",{className:"w-4 h-4 bg-no-repeat bg-center bg-contain card-symbol-".concat(e),title:function(e){switch(e){case"W":return"白色";case"U":return"蓝色";case"B":return"黑色";case"R":return"红色";case"G":return"绿色";case"M":return"多色";case"C":return"无色";default:return""}}(e)},a))})}var x=l(27527);let v=e=>{var a,l,s,n,i,o,c,d,u,v;let{card:b,visible:p,x:g,y:f,expansion:j,isMobile:w,onClose:y}=e,{chineseCards:N}=(0,m.xp)(),_=N[b.name],D=(null==_?void 0:_.atomic_official_name)||(null==_?void 0:_.atomic_translated_name)||(null==_?void 0:_.zhs_name),[S,k]=(0,r.useState)(null),C=e=>e?e.replace(/\\n/g,"\n").replace(/CARDNAME/g,D||b.name):"";if((0,r.useEffect)(()=>{if(!p)return void k(null);p&&(null==_?void 0:_.set)&&(null==_?void 0:_.collector_number)&&fetch("https://mtgch.com/api/v1/card/".concat(_.set.toUpperCase(),"/").concat(_.collector_number)).then(e=>e.json()).then(e=>{let a={zhs_type:e.atomic_translated_type||e.zhs_type_line,zhs_text:e.atomic_translated_text||e.zhs_text||e.oracle_text,zhs_name:e.atomic_official_name||e.atomic_translated_name||e.zhs_name||e.name};k({type:e.other_faces&&e.other_faces.length>0?"double":"normal",data:e.other_faces&&e.other_faces.length>0?[a,{zhs_type:e.other_faces[0].atomic_translated_type||e.other_faces[0].zhs_type_line,zhs_text:e.other_faces[0].atomic_translated_text||e.other_faces[0].zhs_text||e.other_faces[0].oracle_text,zhs_name:e.other_faces[0].atomic_official_name||e.other_faces[0].atomic_translated_name||e.other_faces[0].zhs_name||e.other_faces[0].name}]:[a]})}).catch(console.error)},[p,null==_?void 0:_.set,null==_?void 0:_.collector_number]),!p)return null;let B=(()=>{if(w)return{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"calc(100% - 32px)",maxWidth:"450px",maxHeight:"calc(100vh - 64px)",overflow:"auto"};let e=window.innerHeight,a=window.innerWidth,l=f+10;l+400+10>e&&(l=f-400-10),l<10&&(l=10);let t=g+10;return t+650+10>a&&(t=g-650-10),t<10&&(t=10),t+650>a-10&&(t=a-650-10),{top:l,left:t}})(),R=j.startsWith("Y")?"y".concat(j.slice(j.match(/Y\d{0,2}/)[0].length)).toLowerCase():j.toLowerCase(),M=b.url||((null==_?void 0:_.id)?"https://cards.scryfall.io/normal/front/".concat(_.id.slice(0,1),"/").concat(_.id.slice(1,2),"/").concat(_.id,".jpg"):null);return(0,t.jsxs)(t.Fragment,{children:[w&&p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>{null==y||y();let e=new MouseEvent("mouseleave");document.dispatchEvent(e)}}),(0,t.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 ".concat(w?"overflow-y-auto aspect-[3/4]":"p-4 min-w-[600px]"),style:B,onClick:e=>e.stopPropagation(),children:[w&&(0,t.jsx)("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-800 p-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"font-bold text-lg",children:D}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:b.name})]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),(null==_?void 0:_.set)&&(null==_?void 0:_.collector_number)&&window.open("https://mtgch.com/card/".concat(_.set.toUpperCase(),"/").concat(_.collector_number,"?utm_source=shiqidi"),"_blank")},className:"text-sm text-blue-500 hover:text-blue-600",children:"在 大学院废墟 中查看"})]})}),(0,t.jsx)("div",{className:w?"p-4":"",children:(0,t.jsxs)("div",{className:"flex ".concat(w?"flex-col":"gap-4"),children:[M&&w&&(0,t.jsx)("div",{className:"w-full aspect-[7/5] mb-4 rounded-lg overflow-hidden",children:(0,t.jsx)(x.default,{src:M,alt:b.name,width:350,height:250,className:"w-full h-full object-contain",unoptimized:!0})}),(0,t.jsxs)("div",{className:"space-y-3 flex-1",children:[!w&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-lg",children:D}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:b.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-20 flex justify-end",children:(0,t.jsx)(h,{color:b.color})}),(0,t.jsx)("i",{className:"keyrune ss ss-".concat(R," ss-").concat(b.rarity.toLowerCase()," ss-2x"),title:b.rarity})]})]}),(null==S?void 0:S.data)&&(0,t.jsx)("div",{className:"text-sm p-3 bg-gray-50 dark:bg-gray-900 rounded",children:"normal"===S.type?(0,t.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-[300px]",children:[(0,t.jsx)("div",{className:"font-medium mb-1",children:null==(a=S.data[0])?void 0:a.zhs_type}),(0,t.jsx)("div",{children:C(null==(l=S.data[0])?void 0:l.zhs_text)})]}):(0,t.jsxs)("div",{className:"flex gap-4 max-w-[450px]",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0 whitespace-pre-wrap break-words",children:[(0,t.jsx)("div",{className:"font-medium mb-1",children:null==(s=S.data[0])?void 0:s.zhs_name}),(0,t.jsx)("div",{className:"font-medium text-sm text-gray-600 dark:text-gray-400 mb-1",children:null==(n=S.data[0])?void 0:n.zhs_type}),(0,t.jsx)("div",{children:C(null==(i=S.data[0])?void 0:i.zhs_text)})]}),(0,t.jsx)("div",{className:"w-px bg-gray-200 dark:bg-gray-700 mx-2 shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 whitespace-pre-wrap break-words",children:[(0,t.jsx)("div",{className:"font-medium mb-1",children:null==(o=S.data[1])?void 0:o.zhs_name}),(0,t.jsx)("div",{className:"font-medium text-sm text-gray-600 dark:text-gray-400 mb-1",children:null==(c=S.data[1])?void 0:c.zhs_type}),(0,t.jsx)("div",{children:C(null==(d=S.data[1])?void 0:d.zhs_text)})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm bg-gray-50 dark:bg-gray-900 p-2 rounded",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium text-lg",children:(null==(u=b.avg_seen)?void 0:u.toFixed(1))||"-"}),(0,t.jsx)("div",{className:"text-gray-500",children:"平均抓位"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium text-lg",children:(b.ever_drawn_win_rate?(100*b.ever_drawn_win_rate).toFixed(1):"-")+"%"}),(0,t.jsx)("div",{className:"text-gray-500",children:"在手胜率"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium text-lg",children:(b.drawn_improvement_win_rate?(100*b.drawn_improvement_win_rate).toFixed(1):"-")+"%"}),(0,t.jsx)("div",{className:"text-gray-500",children:"抽到胜率提升"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"见过次数"}),(0,t.jsx)("span",{className:"font-medium",children:b.seen_count||0})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"选择次数"}),(0,t.jsx)("span",{className:"font-medium",children:b.pick_count||0})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"平均选择位置"}),(0,t.jsx)("span",{className:"font-medium",children:(null==(v=b.avg_pick)?void 0:v.toFixed(1))||"-"})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"游戏次数"}),(0,t.jsx)("span",{className:"font-medium",children:b.game_count||0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm border-t pt-2",children:[(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"起手胜率"}),(0,t.jsx)("span",{className:"font-medium",children:(b.opening_hand_win_rate?(100*b.opening_hand_win_rate).toFixed(1):"-")+"%"})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"抽到胜率"}),(0,t.jsx)("span",{className:"font-medium",children:(b.drawn_win_rate?(100*b.drawn_win_rate).toFixed(1):"-")+"%"})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"未抽到胜率"}),(0,t.jsx)("span",{className:"font-medium",children:(b.never_drawn_win_rate?(100*b.never_drawn_win_rate).toFixed(1):"-")+"%"})]}),(0,t.jsxs)("p",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"使用胜率"}),(0,t.jsx)("span",{className:"font-medium",children:(b.win_rate?(100*b.win_rate).toFixed(1):"-")+"%"})]})]})]}),M&&!w&&(0,t.jsx)("div",{className:"w-[240px] h-[340px] flex-shrink-0 rounded-lg overflow-hidden",children:(0,t.jsx)(x.default,{src:M,alt:b.name,width:240,height:340,className:"object-cover",unoptimized:!0})})]})})]})]})};var b=l(58069);function p(e){var a;let{card:l,expansion:s}=e,{chineseCards:n}=(0,m.xp)(),i=n[l.name],o=(null==i?void 0:i.atomic_official_name)||(null==i?void 0:i.atomic_translated_name)||(null==i?void 0:i.zhs_name),c=(0,b.U)("(max-width: 1024px)"),[d,u]=(0,r.useState)(!1),[h,x]=(0,r.useState)({x:0,y:0}),p=(null==i?void 0:i.id)?"https://cards.scryfall.io/art_crop/front/".concat(i.id.slice(0,1),"/").concat(i.id.slice(1,2),"/").concat(i.id,".jpg"):null!=(a=l.url)?a:null;return(0,r.useEffect)(()=>(c&&d?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[c,d]),(0,t.jsxs)("div",{className:"relative max-w-[300px] cursor-pointer",style:{backgroundImage:p?"url(".concat(p,")"):"none",backgroundSize:"cover",backgroundPosition:"50% 20%"},onMouseEnter:()=>!c&&u(!0),onMouseLeave:()=>!c&&u(!1),onMouseMove:e=>{c||x({x:e.clientX,y:e.clientY})},onClick:e=>{if(c){e.preventDefault(),e.stopPropagation();let a=e.currentTarget.getBoundingClientRect();x({x:a.left,y:a.top+window.scrollY}),u(!d)}else(null==i?void 0:i.set)&&(null==i?void 0:i.collector_number)&&window.open("https://mtgch.com/card/".concat(i.set.toUpperCase(),"/").concat(i.collector_number,"?utm_source=shiqidi"),"_blank")},children:[(0,t.jsxs)("div",{className:"relative z-1 bg-black/50 p-1 rounded hover:bg-black/60 transition-colors",children:[(0,t.jsx)("div",{className:"font-medium text-white truncate",children:o||l.name}),(0,t.jsx)("div",{className:"text-sm text-gray-300 truncate",children:l.name})]}),(0,t.jsx)(v,{card:l,visible:d,x:h.x,y:h.y,expansion:s,isMobile:c,onClose:()=>u(!1)})]})}function g(e){let{rank:a,total:l,value:r,zScore:s,mean:n,stdDev:i,label:o,isLowerBetter:c=!1}=e,d=["% GP","GP WR","OH WR","GD WR","GIH WR","GNS WR","IIH"].includes(o),u=e=>d?"".concat((100*e).toFixed(1),"%"):["ALSA","ATA"].includes(o)?e.toFixed(2):e.toFixed(1);return(0,t.jsx)("div",{className:"absolute z-[100] bg-[--component-background] border border-[--border] rounded-md shadow-lg p-2 text-sm min-w-[180px]",children:(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsxs)("div",{className:"font-medium text-[--component-foreground] mb-1",children:[o," 统计"]}),(0,t.jsx)("div",{className:"text-[--component-foreground-muted]",children:(0,t.jsxs)("div",{className:"grid grid-cols-[3.5rem,1fr] gap-x-1",children:[(0,t.jsx)("span",{children:"排名："}),(0,t.jsxs)("span",{className:"text-right",children:[a," / ",l]}),(0,t.jsx)("span",{children:"数值："}),(0,t.jsx)("span",{className:"text-right",children:u(r)}),(0,t.jsx)("span",{children:"Z分数："}),(0,t.jsx)("span",{className:"text-right",children:(c?-s:s).toFixed(1)}),(0,t.jsx)("span",{children:"平均值："}),(0,t.jsxs)("span",{className:"text-right",children:[u(n)," \xb1 ",u(i)]})]})})]})})}var f=l(15972),j=l(39919),w=l(79129),y=l(5446);function N(e){let{value:a,stats:l,label:s,formatter:n=e=>e.toFixed(2)}=e,[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)("right"),u=(0,r.useRef)(null);return((0,r.useEffect)(()=>{if(i&&u.current){let e=u.current,a=e.closest(".card");if(a){let l=e.getBoundingClientRect();d(a.getBoundingClientRect().right-l.right>=200?"right":"left")}}},[i]),null===a||null===l)?(0,t.jsx)("span",{children:"-"}):(0,t.jsxs)("div",{className:"relative inline-block",ref:u,children:[(0,t.jsxs)("span",{className:"cursor-help",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[n(a),(e=>{let a=["ALSA","ATA"].includes(s)?-e:e;return a>=2.5?(0,t.jsx)(f.A,{className:"inline-block w-3 h-3 text-green-500"}):a>=1.5?(0,t.jsx)(j.A,{className:"inline-block w-3 h-3 text-green-500"}):a<=-2.5?(0,t.jsx)(w.A,{className:"inline-block w-3 h-3 text-red-500"}):a<=-1.5?(0,t.jsx)(y.A,{className:"inline-block w-3 h-3 text-red-500"}):null})(l.zScore)]}),i&&(0,t.jsx)("div",{className:"absolute top-0 z-[9999] ".concat("right"===c?"left-full ml-2":"left-[-190px]"),children:(0,t.jsx)(g,{...l,label:s,isLowerBetter:["ALSA","ATA"].includes(s)})})]})}function _(e){return 0===e.length?0:e.reduce((e,a)=>e+a,0)/e.length}function D(e,a,l){if(null===l||"number"!=typeof l||isNaN(l)||!isFinite(l))return null;let t=e.map(e=>e[a]).filter(e=>null!==e&&"number"==typeof e&&!isNaN(e)&&isFinite(e));if(0===t.length)return null;let r="avg_seen"===a||"avg_pick"===a,s=_(t),n=0===t.length?0:Math.sqrt(_(t.map(e=>Math.pow(e-s,2)))),i=0===n?0:(l-s)/n;return{rank:function(e,a){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return[...a].sort((e,a)=>l?e-a:a-e).indexOf(e)+1}(l,t,r),total:t.length,value:l,zScore:i,mean:s,stdDev:n}}let S={common:"普通",uncommon:"非普通",rare:"稀有",mythic:"秘稀"},k={common:1,uncommon:2,rare:3,mythic:4},C=e=>""===e?0:"WUBRG"===e?7:e.length>1?6:({W:1,U:2,B:3,R:4,G:5})[e]||0;function B(e){let{data:a,isLoading:l,expansion:n,onColumnControlsChange:i}=e,o=(0,r.useMemo)(()=>[{header:"卡牌名称",accessorKey:"name",sortable:!0,cell:(e,a)=>(0,t.jsx)(p,{card:a,expansion:n})},{header:"颜色",accessorKey:"color",sortable:!0,cell:e=>(0,t.jsx)("div",{className:"w-12",children:(0,t.jsx)(h,{color:String(e)})})},{header:"稀有度",accessorKey:"rarity",sortable:!0,cell:(e,a,l,r)=>{let s=String(e).toLowerCase(),n=r.startsWith("Y")?"y".concat(r.slice(r.match(/Y\d{0,2}/)[0].length)).toLowerCase():r.toLowerCase();return(0,t.jsx)("i",{className:"keyrune ss ss-".concat(n," ss-").concat(s," ss-2x"),"aria-hidden":"true",title:String(S[s]||e)})}},{header:"# Seen",accessorKey:"seen_count",title:"轮抽中见过的次数",sortable:!0},{header:"ALSA",accessorKey:"avg_seen",title:"平均最后见到的抓位",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"avg_seen",e),label:"ALSA"})},{header:"# Picked",accessorKey:"pick_count",title:"被选择的次数",sortable:!0},{header:"ATA",accessorKey:"avg_pick",title:"平均选择抓位",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"avg_pick",e),label:"ATA"})},{header:"# GP",accessorKey:"game_count",title:"使用过的对局数量",sortable:!0},{header:"% GP",accessorKey:"play_rate",title:"主牌使用率",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"play_rate",e),label:"% GP",formatter:e=>"".concat((100*e).toFixed(1),"%")})},{header:"GP WR",accessorKey:"win_rate",title:"主牌使用时的胜率",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"win_rate",e),label:"GP WR",formatter:e=>"".concat((100*e).toFixed(1),"%")})},{header:"# OH",accessorKey:"opening_hand_game_count",title:"在起手的对局数量",sortable:!0},{header:"OH WR",accessorKey:"opening_hand_win_rate",title:"在起手时的胜率",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"opening_hand_win_rate",e),label:"OH WR",formatter:e=>"".concat((100*e).toFixed(1),"%")})},{header:"# GD",accessorKey:"drawn_game_count",title:"第一回合后抽到的对局数量",sortable:!0},{header:"GD WR",accessorKey:"drawn_win_rate",title:"第一回合后抽到的胜率",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"drawn_win_rate",e),label:"GD WR",formatter:e=>"".concat((100*e).toFixed(1),"%")})},{header:"# GIH",accessorKey:"ever_drawn_game_count",title:"在手上的对局数量(起手或抽到)",sortable:!0},{header:"GIH WR",accessorKey:"ever_drawn_win_rate",title:"在手上时的胜率(起手或抽到)",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"ever_drawn_win_rate",e),label:"GIH WR",formatter:e=>"".concat((100*e).toFixed(1),"%")})},{header:"# GNS",accessorKey:"never_drawn_game_count",title:"未见到的对局数量",sortable:!0},{header:"GNS WR",accessorKey:"never_drawn_win_rate",title:"未见到的胜率",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"never_drawn_win_rate",e),label:"GNS WR",formatter:e=>"".concat((100*e).toFixed(1),"%")})},{header:"IIH",accessorKey:"drawn_improvement_win_rate",title:"在手时的胜率提升",sortable:!0,cell:(e,a,l)=>(0,t.jsx)(N,{value:e,stats:D(l,"drawn_improvement_win_rate",e),label:"IIH",formatter:e=>"".concat((100*e).toFixed(1),"%")})}],[n]),[c,d]=(0,r.useState)({column:void 0,direction:"desc"}),[m,x]=(0,r.useState)(new Set(o.map(e=>String(e.accessorKey))));(0,r.useEffect)(()=>{let e=localStorage.getItem("visibleColumns");e&&x(new Set(JSON.parse(e)))},[]);let v=(0,r.useCallback)(e=>{x(a=>{let l=new Set(a);return l.has(e)?l.delete(e):l.add(e),localStorage.setItem("visibleColumns",JSON.stringify([...l])),l})},[]),b=(0,r.useMemo)(()=>o.filter(e=>m.has(String(e.accessorKey))),[m,o]),g=(0,r.useMemo)(()=>(0,t.jsx)(u,{columns:o,visibleColumns:m,onColumnToggle:v}),[o,m,v]);(0,r.useEffect)(()=>{if(i)return i(g),()=>i(null)},[g,i]);let f=(0,r.useMemo)(()=>c.column?[...a].sort((e,a)=>{let l=e[c.column],t=a[c.column];if(null===l)return 1;if(null===t)return -1;if(l===t)return 0;if("rarity"===c.column){let e=(k[String(l).toLowerCase()]||0)-(k[String(t).toLowerCase()]||0);return"asc"===c.direction?e:-e}if("color"===c.column){let e=C(String(l))-C(String(t));return"asc"===c.direction?e:-e}if(void 0===l)return 1;if(void 0===t)return -1;let r=l<t?-1:1;return"asc"===c.direction?r:-r}):a,[a,c]),j=(0,r.useCallback)(e=>{d(a=>({column:e,direction:a.column===e&&"asc"===a.direction?"desc":"asc"}))},[]);return(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"w-[calc(100vw-2rem)] lg:w-[calc(100vw-4rem)] xl:w-[calc(100vw-6rem)] mx-auto",children:[!i&&(0,t.jsx)("div",{className:"mb-4",children:g}),(0,t.jsx)("div",{className:"card",children:(0,t.jsx)(s,{data:f,columns:b,isLoading:l,emptyText:"暂无卡牌数据",sortColumn:c.column,sortDirection:c.direction,onSort:j,expansion:n})})]})})}let R=[{value:"ever_drawn_win_rate",label:"在手胜率（起手或抽到）",shortLabel:"GIH WR"},{value:"opening_hand_win_rate",label:"起手胜率",shortLabel:"OH WR"},{value:"drawn_win_rate",label:"抽到胜率（第一回合或之后）",shortLabel:"GD WR"},{value:"drawn_improvement_win_rate",label:"在手胜率提升",shortLabel:"IIH"}],M=[{grade:"A+",minStdDev:2.145},{grade:"A",minStdDev:1.815},{grade:"A-",minStdDev:1.485},{grade:"B+",minStdDev:1.155},{grade:"B",minStdDev:.825},{grade:"B-",minStdDev:.495},{grade:"C+",minStdDev:.165},{grade:"C",minStdDev:-.165},{grade:"C-",minStdDev:-.495},{grade:"D+",minStdDev:-.825},{grade:"D",minStdDev:-1.155},{grade:"D-",minStdDev:-1.485},{grade:"F",minStdDev:-1/0},{grade:"-",minStdDev:-1/0}],O=["W","U","B","R","G","M","C"],W={W:"W",U:"U",B:"B",R:"R",G:"G",M:"M",C:"C"};function G(e){var a;let{data:l,allCards:s,metric:n,expansion:i,isLoading:o}=e,c=(0,r.useMemo)(()=>{var e=s&&s.length>0?s:l;let a=e.filter(e=>{let a=e[n];return null!=a&&!isNaN(a)}),t=e.filter(e=>{let a=e[n];return null==a||isNaN(a)}),r=[];if(a.length>0){let{mean:e,stdDev:l}=function(e){if(0===e.length)return{mean:0,stdDev:0};let a=e.reduce((e,a)=>e+a,0)/e.length,l=Math.sqrt(e.reduce((e,l)=>e+Math.pow(l-a,2),0)/e.length);return{mean:a,stdDev:l}}(a.map(e=>e[n]));a.forEach(a=>{let t=a[n],s=l>0?(t-e)/l:0,i=function(e){for(let a of M)if(e>=a.minStdDev)return a.grade;return"F"}(s);r.push({...a,grade:i,stdDevFromMean:s,metricValue:t,hasData:!0})})}return t.forEach(e=>{r.push({...e,grade:"-",stdDevFromMean:0,metricValue:0,hasData:!1})}),r},[l,s,n]),d=(0,r.useMemo)(()=>{let e=new Set(l.map(e=>e.name));return c.filter(a=>e.has(a.name))},[c,l]),u=(0,r.useMemo)(()=>(function(e){let a=new Map;return M.forEach(e=>{let{grade:l}=e;a.set(l,[])}),e.forEach(e=>{let l=a.get(e.grade)||[];l.push(e),a.set(e.grade,l)}),Array.from(a.entries()).map(e=>{let[a,l]=e;return{grade:a,cards:l}}).filter(e=>e.cards.length>0)})(d),[d]),m=(null==(a=R.find(e=>e.value===n))?void 0:a.shortLabel)||n;return o?(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsx)("div",{className:"w-[calc(100vw-2rem)] lg:w-[calc(100vw-4rem)] xl:w-[calc(100vw-6rem)] mx-auto",children:(0,t.jsx)("div",{className:"card h-96 flex items-center justify-center text-[--muted-foreground]",children:"加载中..."})})}):(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"w-[calc(100vw-2rem)] lg:w-[calc(100vw-4rem)] xl:w-[calc(100vw-6rem)] mx-auto space-y-4",children:[(0,t.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,t.jsx)("div",{className:"min-w-[1200px]",children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"grid border-b border-[--border]",style:{gridTemplateColumns:"60px repeat(7, minmax(150px, 1fr))"},children:[(0,t.jsx)("div",{className:"px-2 py-3 text-sm font-semibold text-[--foreground] text-center",children:"评分"}),O.map(e=>(0,t.jsx)("div",{className:"px-4 py-3 text-center",children:(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)("div",{className:"\n                          w-8 h-8 rounded-full flex items-center justify-center\n                          card-symbol-".concat(W[e],"\n                          bg-no-repeat bg-[length:100%_100%]\n                          bg-[--component-background]\n                        ")})})},e))]}),u.map(e=>(0,t.jsx)(L,{grade:e.grade,cards:e.cards,metricLabel:m,expansion:i},e.grade))]})})}),(0,t.jsx)("div",{className:"md:hidden space-y-2",children:u.map(e=>(0,t.jsx)(F,{grade:e.grade,cards:e.cards,metricLabel:m,expansion:i},e.grade))})]})})}function L(e){let{grade:a,cards:l,metricLabel:s,expansion:n}=e,i=(0,r.useMemo)(()=>{let e={W:[],U:[],B:[],R:[],G:[],M:[],C:[]};return l.forEach(a=>{let l=a.color||"";""===l?e.C.push(a):1===l.length?e[l]&&e[l].push(a):e.M.push(a)}),Object.keys(e).forEach(a=>{e[a].sort((e,a)=>a.metricValue-e.metricValue)}),e},[l]);return 0===l.length?null:(0,t.jsxs)("div",{className:"grid border-b border-[--border] hover:bg-[--background-hover] transition-colors",style:{gridTemplateColumns:"60px repeat(7, minmax(150px, 1fr))"},children:[(0,t.jsx)("div",{className:"px-2 py-3 flex items-start justify-center",children:(0,t.jsx)("div",{className:"text-lg font-bold",children:a})}),O.map(e=>(0,t.jsx)("div",{className:"px-2 py-3",children:(0,t.jsx)("div",{className:"space-y-1",children:i[e].map((l,r)=>(0,t.jsx)(E,{card:l,grade:a,metricLabel:s,expansion:n},"".concat(l.name,"-").concat(e,"-").concat(r)))})},e))]})}function F(e){let{grade:a,cards:l,metricLabel:s,expansion:n}=e,i=(0,r.useMemo)(()=>[...l].sort((e,a)=>a.metricValue-e.metricValue),[l]);return 0===l.length?null:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"px-4 py-3 border-b border-[--border]",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-lg font-bold",children:a}),(0,t.jsxs)("div",{className:"text-sm text-[--foreground-muted]",children:[l.length," 张卡牌"]})]})}),(0,t.jsx)("div",{className:"p-2 space-y-2",children:i.map((e,l)=>(0,t.jsx)(E,{card:e,grade:a,metricLabel:s,expansion:n},"".concat(e.name,"-mobile-").concat(l)))})]})}function E(e){var a,l;let{card:s,metricLabel:n,expansion:i}=e,{chineseCards:o}=(0,m.xp)(),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)({x:0,y:0}),x=(0,b.U)("(max-width: 1024px)"),p=(100*s.metricValue).toFixed(1),g={mythic:{border:"rgba(191, 68, 39, 0.9)",gradient:"linear-gradient(180deg, rgba(216, 90, 60, 0.95) 0%, rgba(191, 68, 39, 0.95) 100%)",glow:"rgba(191, 68, 39, 0.45)"},rare:{border:"rgba(165, 142, 74, 0.95)",gradient:"linear-gradient(180deg, rgba(192, 169, 107, 0.95) 0%, rgba(165, 142, 74, 0.95) 100%)",glow:"rgba(165, 142, 74, 0.4)"},uncommon:{border:"rgba(112, 120, 131, 0.9)",gradient:"linear-gradient(180deg, rgba(142, 149, 158, 0.95) 0%, rgba(112, 120, 131, 0.95) 100%)",glow:"rgba(112, 120, 131, 0.45)"},common:{border:"rgba(25, 23, 27, 0.95)",gradient:"linear-gradient(180deg, rgba(40, 36, 38, 0.95) 0%, rgba(19, 17, 18, 0.95) 100%)",glow:"rgba(25, 23, 27, 0.5)"}}[(null==(a=s.rarity)?void 0:a.toLowerCase())||""]||{border:"rgba(107,114,128,0.9)",gradient:"linear-gradient(180deg, rgba(156,163,175,0.95) 0%, rgba(107,114,128,0.95) 100%)",glow:"rgba(107,114,128,0.45)"},f=o[s.name],j=(null==f?void 0:f.atomic_official_name)||(null==f?void 0:f.atomic_translated_name)||(null==f?void 0:f.zhs_name),w=(null==f?void 0:f.id)?"https://cards.scryfall.io/art_crop/front/".concat(f.id.slice(0,1),"/").concat(f.id.slice(1,2),"/").concat(f.id,".jpg"):void 0,y=null!=(l=null!=w?w:s.url)?l:null;return(0,r.useEffect)(()=>(x&&c?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[x,c]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"relative rounded border border-[--border] hover:brightness-110 transition-all cursor-pointer overflow-hidden",style:{backgroundImage:y?"url(".concat(y,")"):"none",backgroundSize:"cover",backgroundPosition:"50% 20%",borderLeftColor:g.border,borderLeftWidth:"4px",borderLeftStyle:"solid"},title:s.hasData?"".concat(n,": ").concat(p,"% | Z-Score: ").concat(s.stdDevFromMean.toFixed(2)):"无数据",onMouseEnter:()=>!x&&d(!0),onMouseMove:e=>{x||h({x:e.clientX,y:e.clientY})},onMouseLeave:()=>!x&&d(!1),onClick:e=>{if(x){e.preventDefault(),e.stopPropagation();let a=e.currentTarget.getBoundingClientRect();h({x:a.left,y:a.top+window.scrollY}),d(!c)}else(null==f?void 0:f.set)&&(null==f?void 0:f.collector_number)&&window.open("https://mtgch.com/card/".concat(f.set.toUpperCase(),"/").concat(f.collector_number,"?utm_source=shiqidi"),"_blank")},children:(0,t.jsx)("div",{className:"relative z-1",children:(0,t.jsx)("div",{className:"bg-black/50 pl-2 pr-1.5 py-1.5 hover:bg-black/60 transition-colors",style:{boxShadow:"inset 5px 0 8px -4px ".concat(g.glow)},children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-1",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-xs font-medium text-white truncate leading-tight",children:j||s.name}),(0,t.jsx)("div",{className:"text-[10px] text-gray-300 truncate leading-tight",children:s.name})]}),s.hasData&&(0,t.jsxs)("div",{className:"flex-shrink-0 flex items-center text-xs font-bold text-white",style:{height:"calc(1em * 1.2 + 0.625rem)"},children:[p,"%"]})]})})})}),(0,t.jsx)(v,{card:s,visible:c,x:u.x,y:u.y,expansion:i,isMobile:x,onClose:()=>d(!1)})]})}var A=l(70557),z=l(67283),I=l(55002),U=l.n(I);l(46571);var T=l(38232);function K(e){let{startDate:a,endDate:l,onStartDateChange:r,onEndDateChange:s}=e,n=(0,b.U)("(max-width: 1024px)"),i="form-control w-full sm:w-32 bg-[--component-background] border border-[--border] rounded-md px-3 py-2 text-sm text-[--component-foreground] focus:border-[--primary] focus:outline-none focus:ring-1 focus:ring-[--primary]";return(0,t.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,t.jsx)(U(),{selected:a,onChange:e=>e&&r(e),selectsStart:!0,startDate:a,endDate:l,maxDate:l,placeholderText:"开始日期",className:i,withPortal:n,portalId:"date-picker-portal",dateFormat:"yyyy/MM/dd",locale:T.g}),(0,t.jsx)("span",{className:"text-[--component-foreground-muted] shrink-0",children:"–"}),(0,t.jsx)(U(),{selected:l,onChange:e=>e&&s(e),selectsEnd:!0,startDate:a,endDate:l,minDate:a,maxDate:new Date,placeholderText:"结束日期",className:i,withPortal:n,portalId:"date-picker-portal",dateFormat:"yyyy/MM/dd",locale:T.g})]})}var P=l(53474);function Y(e){let{open:a,onClose:l,children:s,anchor:n}=e,i=(0,r.useRef)(null);if((0,r.useEffect)(()=>{if(!a)return;let e=e=>{let a=e.target,t=document.getElementById("date-picker-portal");(null==t?void 0:t.contains(a))||!i.current||i.current.contains(a)||!n||n.contains(a)||l()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a,l,n]),!a||!n)return null;let o=n.getBoundingClientRect();return(0,P.createPortal)((0,t.jsx)("div",{ref:i,className:"fixed z-50 w-[calc(100vw-2rem)] max-w-md bg-[--background] rounded-lg shadow-lg p-4 space-y-4 max-h-[80vh] overflow-y-auto",style:{top:"".concat(o.bottom+8,"px"),left:"50%",transform:"translateX(-50%)"},children:s}),document.body)}var H=l(76138),q=l(3163),Q=l(56440);function V(e){let{params:a,onParamsChange:l,onColorFilter:s,selectedColors:n,onRarityFilter:i,selectedRarities:o,onSearchFilter:c,searchText:d}=e,u=(0,H.H)(a.start_date),m=(0,H.H)(a.end_date),h=(0,b.U)("(max-width: 1024px)"),[x,v]=(0,r.useState)(!1),p=(0,r.useRef)(null),g=(0,r.useMemo)(()=>{let e=(0,Q.Ry)(a.expansion);return q.or.filter(a=>e.includes(a.value))},[a.expansion]),f=e=>{let t=(0,Q.Ry)(e),r={expansion:e};if(!t.includes(a.format)&&t.length>0){let e=q.or.find(e=>t.includes(e.value));e?r.format=e.value:r.format=t[0]}let s=(0,Q.t)(e);s&&(r.start_date=s.split("T")[0]),l(r)},[j,w]=(0,r.useState)(a),[y,N]=(0,r.useState)(n),[_,D]=(0,r.useState)(o);return(0,t.jsxs)("div",{className:"space-y-4",children:[h?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(A.p,{placeholder:"搜索卡牌名称...",value:d,onChange:e=>c(e.target.value),className:"flex-1"}),(0,t.jsx)(z.l,{options:q.Id,value:a.expansion,onChange:e=>f(e.target.value),title:"系列",className:"w-32 shrink-0"}),(0,t.jsx)("button",{ref:p,onClick:()=>{w(a),N(n),D(o),v(!0)},className:"\n              p-2 rounded-md transition-colors shrink-0\n              ".concat(x?"bg-[--primary] text-white":"bg-[--component-background] hover:bg-[--component-background-hover]","\n            "),"aria-label":"显示筛选选项",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,t.jsx)("path",{d:"M10 3.75a2 2 0 10-4 0 2 2 0 004 0zM17.25 4.5a.75.75 0 000-1.5h-5.5a.75.75 0 000 1.5h5.5zM5 3.75a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5a.75.75 0 01.75.75zM4.25 17a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5h1.5zM17.25 17a.75.75 0 000-1.5h-5.5a.75.75 0 000 1.5h5.5zM9 10a.75.75 0 01-.75.75h-5.5a.75.75 0 010-1.5h5.5A.75.75 0 019 10zM17.25 10.75a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5h1.5zM14 10a2 2 0 10-4 0 2 2 0 004 0zM10 16.25a2 2 0 10-4 0 2 2 0 004 0z"})})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)(A.p,{placeholder:"搜索卡牌名称...",value:d,onChange:e=>c(e.target.value),className:"w-full sm:w-64"}),(0,t.jsx)("div",{className:"w-full sm:w-auto",children:(0,t.jsx)(K,{startDate:u,endDate:m,onStartDateChange:e=>l({start_date:e.toISOString().split("T")[0]}),onEndDateChange:e=>l({end_date:e.toISOString().split("T")[0]})})})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-4",children:[(0,t.jsx)(z.l,{options:q.Id,value:a.expansion,onChange:e=>f(e.target.value),title:"系列",className:"w-full sm:w-32 shrink-0"}),(0,t.jsx)(z.l,{options:g,value:a.format,onChange:e=>l({format:e.target.value}),title:"模式",className:"w-full sm:w-auto sm:min-w-[140px]"}),(0,t.jsx)(z.l,{options:q.bf,value:a.user_group,onChange:e=>l({user_group:e.target.value}),title:"用户组",className:"w-full sm:w-auto sm:min-w-[100px]"}),(0,t.jsx)(z.l,{options:q.x3,value:a.colors||"",onChange:e=>l({colors:e.target.value}),title:"套牌颜色",className:"w-full sm:w-auto sm:min-w-[120px]"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-[--component-foreground-muted] whitespace-nowrap",children:"卡牌颜色:"}),(0,t.jsx)("div",{className:"flex gap-1",children:q.qW.map(e=>(0,t.jsx)("button",{className:"\n                      w-8 h-8 rounded-full flex items-center justify-center\n                      card-symbol-".concat(e.value,"\n                      bg-no-repeat bg-[length:100%_100%]\n                      ").concat(n.includes(e.value)?"ring-2 ring-[#FFB000] ring-opacity-80":"hover:ring-2 hover:ring-[#FFB000] hover:ring-opacity-50 brightness-75","\n                      bg-[--component-background] hover:bg-[--component-background-hover]\n                      transition-all\n                    "),onClick:()=>{s(n.includes(e.value)?n.filter(a=>a!==e.value):[...n,e.value])}},e.value))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-[--component-foreground-muted] whitespace-nowrap",children:"稀有度:"}),(0,t.jsx)("div",{className:"flex gap-1",children:q.YV.map(e=>{let l=a.expansion,r=l.toLowerCase().startsWith("y")?"y".concat(l.slice(l.match(/Y\d{0,2}/)[0].length)).toLowerCase():l.toLowerCase();return(0,t.jsx)("button",{className:"\n                        w-8 h-8 rounded-full flex items-center justify-center\n                        ".concat(o.includes(e.value)?"ring-2 ring-[#FFB000] ring-opacity-80":"hover:ring-2 hover:ring-[#FFB000] hover:ring-opacity-50 brightness-75","\n                        transition-all\n                      "),onClick:()=>{i(o.includes(e.value)?o.filter(a=>a!==e.value):[...o,e.value])},title:e.label,children:(0,t.jsx)("i",{className:"keyrune ss ss-".concat(r," ss-").concat(e.value," ss-2x"),"aria-hidden":"true",style:{backgroundColor:"transparent"}})},e.value)})})]})]})]}),h&&(0,t.jsx)(Y,{open:x,onClose:()=>v(!1),anchor:p.current,children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(K,{startDate:(0,H.H)(j.start_date),endDate:(0,H.H)(j.end_date),onStartDateChange:e=>w({...j,start_date:e.toISOString().split("T")[0]}),onEndDateChange:e=>w({...j,end_date:e.toISOString().split("T")[0]})}),(0,t.jsx)(z.l,{options:g,value:j.format,onChange:e=>w({...j,format:e.target.value}),title:"模式",className:"w-full"}),(0,t.jsx)(z.l,{options:q.bf,value:j.user_group,onChange:e=>w({...j,user_group:e.target.value}),title:"用户组",className:"w-full"}),(0,t.jsx)(z.l,{options:q.x3,value:j.colors||"",onChange:e=>w({...j,colors:e.target.value}),title:"套牌颜色",className:"w-full"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("span",{className:"text-sm text-[--component-foreground-muted] whitespace-nowrap",children:"卡牌颜色:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:q.qW.map(e=>(0,t.jsx)("button",{className:"\n                      w-8 h-8 rounded-full flex items-center justify-center\n                      card-symbol-".concat(e.value,"\n                      bg-no-repeat bg-[length:100%_100%]\n                      ").concat(y.includes(e.value)?"ring-2 ring-[#FFB000] ring-opacity-80":"hover:ring-2 hover:ring-[#FFB000] hover:ring-opacity-50 brightness-75","\n                      bg-[--component-background] hover:bg-[--component-background-hover]\n                      transition-all\n                    "),onClick:()=>{N(y.includes(e.value)?y.filter(a=>a!==e.value):[...y,e.value])}},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("span",{className:"text-sm text-[--component-foreground-muted] whitespace-nowrap",children:"稀有度:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:q.YV.map(e=>{let l=a.expansion,r=l.toLowerCase().startsWith("y")?"y".concat(l.slice(l.match(/Y\d{0,2}/)[0].length)).toLowerCase():l.toLowerCase();return(0,t.jsx)("button",{className:"\n                        w-8 h-8 rounded-full flex items-center justify-center\n                        ".concat(_.includes(e.value)?"ring-2 ring-[#FFB000] ring-opacity-80":"hover:ring-2 hover:ring-[#FFB000] hover:ring-opacity-50 brightness-75","\n                        transition-all\n                      "),onClick:()=>{D(_.includes(e.value)?_.filter(a=>a!==e.value):[..._,e.value])},title:e.label,children:(0,t.jsx)("i",{className:"keyrune ss ss-".concat(r," ss-").concat(e.value," ss-2x"),"aria-hidden":"true",style:{backgroundColor:"transparent"}})},e.value)})})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsx)("button",{onClick:()=>{Object.entries(j).some(e=>{let[l,t]=e;return a[l]!==t})&&l(j),s(y),i(_),v(!1)},className:"px-4 py-2 bg-[--primary] text-white rounded-md hover:bg-[--primary]/90 transition-colors",children:"确定"})})]})})]})}function $(e){let{set:a}=e,l=a.startsWith("Y")?"y".concat(a.slice(a.match(/Y\d{0,2}/)[0].length)).toLowerCase():a.toLowerCase();return(0,t.jsx)("i",{className:"keyrune ss ss-2x ss-".concat(l),"aria-hidden":"true"})}async function X(e){let a=new URLSearchParams({expansion:e.expansion,format:e.format,start_date:e.start_date,end_date:e.end_date});e.user_group&&a.append("user_group",e.user_group),e.colors&&a.append("colors",e.colors);let l=await fetch("https://www.17lands.com/card_ratings/data?".concat(a),{headers:{accept:"application/json"}});if(!l.ok)throw Error("Failed to fetch card data");return l.json()}async function J(e){let a=await fetch("https://mtgch.com/api/v1/set/".concat(e,"/cards/?unique=oracle_id&priority_chinese=true"),{headers:{accept:"application/json"}});if(!a.ok)throw Error("Failed to fetch Chinese card data");return a.json()}async function Z(e,a){let l=new URLSearchParams({page:"1",page_size:"100",unique:"oracle_id",priority_chinese:"true",q:e.map(e=>'name="'.concat(e,'"')).join(" or ")}),t=await fetch("https://mtgch.com/api/v1/result?".concat(l),{headers:{accept:"application/json"}});if(!t.ok)throw Error("Failed to search Chinese card data");let r=await t.json();return a&&r.results&&a(r.results),r}let ee=!1,ea={},el=new Set;async function et(e,a,l){try{let r;el.has(e)&&ea[e]?r={items:ea[e]}:(r=await J(e)).items&&(ea[e]=r.items,el.add(e));let s={items:[]},n=e.match(/^Y\d{1,2}([A-Z]+)/);if(n){let a=n[1],l="Y".concat(a);if(l!==e)if(el.has(l)&&ea[l])s={items:ea[l]};else try{(s=await J(l)).items&&(ea[l]=s.items,el.add(l))}catch(e){console.warn("Failed to fetch canonical Y-set data for ".concat(l,":"),e)}}let i={items:[]};if(ee)ea.SPG&&(i={items:ea.SPG});else{var t;(null==(t=(i=await J("SPG")).items)?void 0:t.length)>0&&(ea.SPG=i.items,ee=!0)}let o=[...r.items||[],...s.items||[],...i.items||[]];l&&o.length>0&&l(o);let c=new Map(o.flatMap(e=>e.face_name?[[e.name,e],[e.face_name,e]]:[[e.name,e]])),d=a.filter(e=>!c.has(e.name));if(d.length>0){let e=function(e,a){let l=[];for(let a=0;a<e.length;a+=30)l.push(e.slice(a,a+30));return l}(d,30);for(let a=0;a<e.length;a++){let t=e[a];try{let e=await Z(t.map(e=>e.name));e.items&&(o.push(...e.items),e.items.forEach(e=>{e.set&&!ea[e.set]&&(ea[e.set]=[]),e.set&&!ea[e.set].some(a=>a.name===e.name)&&ea[e.set].push(e)}),l&&l([...o]))}catch(e){console.error("Failed to search Chinese card data:",e)}}}return o}catch(e){return console.error("Failed to fetch all Chinese card data:",e),[]}}var er=l(62730);function es(){let[e,a]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{let e=()=>{a(window.scrollY>300)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),e)?(0,t.jsx)(n.$,{variant:"secondary",size:"icon",className:"fixed bottom-8 right-8 z-50 rounded-full shadow-lg",onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},title:"回到顶部",children:(0,t.jsx)(er.A,{className:"h-5 w-5"})}):null}function en(){let[e,a]=(0,r.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>a(!0),className:"h-6 w-6 text-[--foreground-muted] hover:text-[--foreground]",title:"评分计算说明",children:(0,t.jsx)(i.A,{className:"h-4 w-4"})}),e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>a(!1)}),(0,t.jsxs)("div",{className:"relative z-10 w-full max-w-lg mx-4 rounded-xl bg-[--component-background] border border-[--border] shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[--border]",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-[--foreground]",children:"评分计算说明"}),(0,t.jsx)("button",{type:"button",onClick:()=>a(!1),className:"text-[--foreground-muted] hover:text-[--foreground]",children:(0,t.jsx)(o.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"px-4 py-4 space-y-3 text-sm leading-relaxed text-[--foreground-muted]",children:(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-2",children:[(0,t.jsxs)("li",{children:["评分视图基于所选胜率指标（GIH、OH、GD 或 IIH）构建正态分布，并以 ",(0,t.jsx)("span",{className:"font-semibold text-[--foreground]",children:"C"})," 为中心。 每一个字母等级的半级差异（例如 C 与 C+）代表相对于均值 ",(0,t.jsx)("span",{className:"font-semibold text-[--foreground]",children:"\xb10.33 个标准差"})," 的区间。 根据我们对用户牌表的分析，这与限制赛社区常见的评分方式最为贴近。"]}),(0,t.jsx)("li",{children:"应用会影响卡牌具体数据的筛选条件（例如：赛制、用户、套牌、日期范围）时，整体分布会被重新计算，等级也会随之重新分配。"}),(0,t.jsx)("li",{children:"对于不会改变卡牌数据的筛选条件（例如：颜色、稀有度），仅会隐藏不符合条件的卡牌，不会影响已计算的评分。"})]})}),(0,t.jsx)("div",{className:"px-4 py-3 border-t border-[--border] flex justify-end",children:(0,t.jsx)(n.$,{variant:"secondary",size:"sm",onClick:()=>a(!1),children:"我知道了"})})]})]})]})}function ei(){let{cards:e,params:a,chineseCards:l,isLoading:s,setCards:i,setChineseCards:o,setIsLoading:c,setError:d,setParams:u}=(0,m.xp)(),[h,x]=(0,r.useState)([]),[v,b]=(0,r.useState)([]),[p,g]=(0,r.useState)(""),[f,j]=(0,r.useState)("table"),[w,y]=(0,r.useState)("ever_drawn_win_rate"),[N,_]=(0,r.useState)(null),D=(0,r.useMemo)(()=>{let a=e;if(p){let e=p.toLowerCase();a=a.filter(a=>{let t=a.name.toLowerCase().includes(e),r=l[a.name],s=(null==r?void 0:r.atomic_official_name)||(null==r?void 0:r.atomic_translated_name)||(null==r?void 0:r.zhs_name),n=null==s?void 0:s.toLowerCase().includes(e);return t||n})}return h.length>0&&(a=a.filter(e=>{let a=e.color?e.color.split(""):[],l=a.length>1,t=0===a.length,r=h.includes("M"),s=h.includes("C");if(t&&s)return!0;if(r){if(!l)return!1;let e=h.filter(e=>"WUBRG".includes(e));return!(e.length>0)||e.every(e=>a.includes(e))}let n=h.filter(e=>"WUBRG".includes(e));return n.length>0&&n.some(e=>a.includes(e))})),v.length>0&&(a=a.filter(e=>v.includes(e.rarity.toLowerCase()))),a},[e,p,h,v,l]);return(0,r.useEffect)(()=>{!async function(){try{c(!0);let e=await X(a);i(e),c(!1),et(a.expansion,e,e=>{o(e)}).catch(e=>{console.error("Failed to load Chinese card data:",e)})}catch(e){d(e),c(!1)}}()},[a,i,o,c,d]),(0,r.useEffect)(()=>{"table"!==f&&_(null)},[f]),(0,t.jsxs)("div",{className:"py-8",children:[(0,t.jsxs)("div",{className:"container mx-auto px-4 mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,t.jsx)($,{set:a.expansion}),(0,t.jsxs)("h1",{className:"text-2xl font-semibold",children:[a.expansion," 轮抽卡牌数据"]}),(0,t.jsxs)("a",{href:"https://www.17lands.com/card_data?utm_source=shiqidi",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-[--accent]/10 text-[--muted-foreground] hover:text-[--foreground] hover:bg-[--accent]/20 transition-colors",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-3 h-3",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.25 5.5a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0112.75 17h-8.5A2.25 2.25 0 012 14.75v-8.5A2.25 2.25 0 014.25 4h5a.75.75 0 010 1.5h-5z",clipRule:"evenodd"}),(0,t.jsx)("path",{fillRule:"evenodd",d:"M6.194 12.753a.75.75 0 001.06.053L16.5 4.44v2.81a.75.75 0 001.5 0v-4.5a.75.75 0 00-.75-.75h-4.5a.75.75 0 000 1.5h2.553l-9.056 8.194a.75.75 0 00-.053 1.06z",clipRule:"evenodd"})]}),"17Lands"]})]}),(0,t.jsx)(V,{params:a,onParamsChange:u,onColorFilter:x,selectedColors:h,onRarityFilter:b,selectedRarities:v,onSearchFilter:g,searchText:p}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-6 p-4 bg-[--component-background] rounded-lg border border-[--border]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,t.jsxs)(n.$,{variant:"grades"===f?"secondary":"ghost",size:"sm",onClick:()=>j("grades"),className:"flex items-center gap-2",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:(0,t.jsx)("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),"评分视图"]}),(0,t.jsxs)(n.$,{variant:"table"===f?"secondary":"ghost",size:"sm",onClick:()=>j("table"),className:"flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[(0,t.jsx)("rect",{x:"3",y:"4",width:"18",height:"16",rx:"2",ry:"2"}),(0,t.jsx)("path",{d:"M3 9h18"}),(0,t.jsx)("path",{d:"M8 3v2"}),(0,t.jsx)("path",{d:"M16 3v2"})]}),"表格视图"]})]}),"grades"===f&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm text-[--foreground-muted]",children:[(0,t.jsx)("span",{children:"评分指标："}),(0,t.jsx)(en,{})]}),R.map(e=>(0,t.jsx)(n.$,{variant:w===e.value?"secondary":"ghost",size:"sm",onClick:()=>y(e.value),title:e.label,children:e.shortLabel},e.value))]}),"table"===f&&N&&(0,t.jsx)("div",{className:"flex-1 min-w-[240px] ml-auto",children:N})]})]}),"table"===f?(0,t.jsx)(B,{data:D,isLoading:s,expansion:a.expansion,onColumnControlsChange:_}):(0,t.jsx)(G,{data:D,allCards:e,metric:w,expansion:a.expansion,isLoading:s}),(0,t.jsx)(es,{})]})}}},e=>{e.O(0,[928,593,527,232,192,848,451,75,358],()=>e(e.s=1572)),_N_E=e.O()}]);